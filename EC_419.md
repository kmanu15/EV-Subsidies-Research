EC_418_dataset
================
Kojo Manu
2024-01-24

Packages

``` r
library(tidyr)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(ggplot2)
```

Creating income data set for just Washington

``` r
data01 = read.csv("Data Sets/Census_Income.csv")

# Separating Washington data from the rest
Census_Washington <- data01[80385:82168, ]

# Save in a specific directory
write.csv(Census_Washington, file = "Data Sets/Census_Washington.csv")
```

Making the data sets easier to merge

``` r
# Separate NAME column into new columns 'Census_Tract' and 'County'
Census_Washington <- separate(Census_Washington, Geographic.Area.Name, into = c("Census_Tract", "County"), sep = ";")
```

    ## Warning: Expected 2 pieces. Additional pieces discarded in 1784 rows [1, 2, 3, 4, 5, 6,
    ## 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].

``` r
# Removing the words 'Census Tract' from the Census_Tract column
Census_Washington$Census_Tract <- as.numeric(gsub("[^0-9.]", "", Census_Washington$Census_Tract))

# Remove the word 'county' from the County column
Census_Washington$County <- gsub(" County", "", Census_Washington$County)

# Loading Washington_Data
Washington_Data <- read.csv("Data Sets/Washington_Data.csv")

Washington_Data <- Washington_Data %>% rename(Census_Tract = 'X2020.Census.Tract')

# Removing state and county FIPS codes (first 5 numbers) from the 'Census_Tract' column
Washington_Data$Census_Tract <- substr(Washington_Data$Census_Tract, 6, nchar(Washington_Data$Census_Tract))

# Add a decimal to the column 'Census_Tract' to match the Census_Washington data set
Washington_Data$Census_Tract <- paste0(substr(Washington_Data$Census_Tract, 1, nchar(Washington_Data$Census_Tract) - 2), ".", substr(Washington_Data$Census_Tract, nchar(Washington_Data$Census_Tract) - 1, nchar(Washington_Data$Census_Tract)))

# Convert the columns to numeric
Washington_Data$Census_Tract <- as.numeric(Washington_Data$Census_Tract)
```

    ## Warning: NAs introduced by coercion

``` r
Census_Washington$Census_Tract <- as.numeric(Census_Washington$Census_Tract)

# Remove all spaces
Census_Washington$County <- gsub("\\s", "", Census_Washington$County)
```

Merge the data sets into one for regression analysis

``` r
# Merging the data sets
merged_df <- merge(Washington_Data, Census_Washington, by = c("Census_Tract", "County"), all = TRUE)

# Saving the new data set
write.csv(merged_df, file = "Data Sets/merged_df.csv")

# Adding a column that shows the number of cars per census tract
merged_df <- merged_df %>%
  group_by(Census_Tract) %>% mutate(Total_Vehicles_in_Tract = n())

# Adding a column that shows avg # of vehicles per household
merged_df$Estimate..Households..Total <- as.numeric(merged_df$Estimate..Households..Total)
merged_df <- merged_df %>% mutate(Vehicles_per_Household = Total_Vehicles_in_Tract / Estimate..Households..Total)

merged_df$Rebate <- ifelse(merged_df$Model.Year >= 2019, 1, 0)
```

Running Regressions

``` r
# Renaming Variables
merged_df <- merged_df %>% 
  rename(
    Median_Income = Estimate..Households..Median.income..dollars.,
    Number_of_Households = Estimate..Households..Total,
    Mean_Income = Estimate..Households..Mean.income..dollars.
    )

merged_df$Median_Income <- as.numeric(merged_df$Median_Income)
```

    ## Warning: NAs introduced by coercion

``` r
merged_df$Mean_Income <- as.numeric(merged_df$Mean_Income)
```

    ## Warning: NAs introduced by coercion

``` r
# First regression
reg1 <- lm(data = merged_df, Vehicles_per_Household ~ Median_Income + Rebate + I(Median_Income * Rebate) + Number_of_Households)
summary(reg1)
```

    ## 
    ## Call:
    ## lm(formula = Vehicles_per_Household ~ Median_Income + Rebate + 
    ##     I(Median_Income * Rebate) + Number_of_Households, data = merged_df)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -0.10669 -0.04852 -0.02129  0.01285  0.77988 
    ## 
    ## Coefficients:
    ##                             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                9.987e-03  1.805e-03   5.532 3.17e-08 ***
    ## Median_Income              8.389e-07  1.194e-08  70.242  < 2e-16 ***
    ## Rebate                     6.882e-02  1.823e-03  37.749  < 2e-16 ***
    ## I(Median_Income * Rebate) -4.105e-07  1.407e-08 -29.173  < 2e-16 ***
    ## Number_of_Households      -7.896e-06  4.900e-07 -16.116  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.1062 on 147706 degrees of freedom
    ##   (6183 observations deleted due to missingness)
    ## Multiple R-squared:  0.0619, Adjusted R-squared:  0.06187 
    ## F-statistic:  2436 on 4 and 147706 DF,  p-value: < 2.2e-16

Descriptive Stats

``` r
# Box Plots

# Income
options(scipen = 999)
boxplot(merged_df$Median_Income, merged_df$Mean_Income,
        xlab = 'Dollars',
        names = c('Median Income', 'Mean Income'),
        main = 'Income',
        horizontal = T)
```

![](EC_419_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r
boxplot(merged_df$Number_of_Households,
        main = '# of Housholds per Tract',
        horizontal = T)
```

![](EC_419_files/figure-gfm/unnamed-chunk-6-2.png)<!-- -->

``` r
# Scatter Plots

# Median Income vs Care Make
ggplot(data = merged_df, aes(x = Median_Income, y = Make)) + 
  geom_point(size = .5) +
  labs(title = 'Median Income vs Car Make', x = 'Median Income ($)') +
  theme_minimal()
```

    ## Warning: Removed 6134 rows containing missing values or values outside the scale range
    ## (`geom_point()`).

![](EC_419_files/figure-gfm/unnamed-chunk-6-3.png)<!-- -->

Correlation Matrix

``` r
# Choosing which variables to include in the correlation matrix
selected_vars <- c('Median_Income', 'Mean_Income')

Cor_Matrix <- cor(merged_df[, selected_vars], use = "pairwise.complete.obs")
print(Cor_Matrix)
```

    ##               Median_Income Mean_Income
    ## Median_Income     1.0000000   0.9192328
    ## Mean_Income       0.9192328   1.0000000
